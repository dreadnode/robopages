description: Analyse suspicious files, domains, IPs and URLs to detect malware and other breaches, automatically share them with the security community.

functions:
  virustotal_hash_lookup:
    description: Lookup a given hash with VirusTotal.
    parameters:
      hash:
        type: string
        description: MD5/SHA1/SHA256 hash of file
        examples:
          - d41d8cd98f00b204e9800998ecf8427e  # MD5 example
          - da39a3ee5e6b4b0d3255bfef95601890afd80709  # SHA1 example
          - e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855  # SHA256 example
      api_key:
        type: string
        description: Your VirusTotal API key
        examples:
          - 0123456789abcdef
    container:
      platform: linux/amd64
      image: malice/virustotal
    cmdline:  # https://hub.docker.com/r/malice/virustotal
      - virustotal
      - --api
      - ${api_key}
      - lookup
      - ${hash}
      - --t
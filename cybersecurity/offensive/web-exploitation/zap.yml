description: The Zed Attack Proxy (ZAP) is one of the worldâ€™s most popular free security tools and is actively maintained by a dedicated international team of volunteers. It can help you automatically find security vulnerabilities in your web applications while you are developing and testing your applications. It's also a great tool for experienced pentesters to use for manual security testing.

categories:
  - cybersecurity
  - offensive
  - web-exploitation

functions:
  zap_baseline_scan:
    description: Run a baseline target scan with ZAP, it runs the ZAP spider against the specified target for (by default) 1 minute and then waits for the passive scanning to complete before reporting the results.
    parameters:
      target:
        type: string
        description: The URL of the target to scan.
        examples:
          - https://scanme.nmap.org/
    container:
      image: zaproxy/zap-stable
      args:
        - --net=host
      volumes:
        - "${HOME}:/zap/wrk"

    cmdline: # https://www.zaproxy.org/docs/docker/about/
      - zaproxy/zap-weekly
      - zap-baseline.py
      - -t
      - ${target}
      - zap_headless_scan

  zap_scan_host_os_app:
    description: Run a baseline target scan with ZAP on a host OS app.
    parameters:
      localhost_app:
        type: string
        description: IP addresses like localhost and 127.0.0.1 cannot be used to access an app running on the host OS from within a docker container. To get around this you can use the following code to get an IP address that will work.
        examples:
          - "$(ip -f inet -o addr show docker0 | awk '{print $4}' | cut -d '/' -f 1)"
    container:
      image: zaproxy/zap-stable
      args:
        - --net=host
      volumes:
        - "$(pwd):/zap/wrk"

    cmdline: # https://www.zaproxy.org/docs/docker/about/s
      - zaproxy/zap-weekly
      - zap-baseline.py
      - -t
      - ${localhost_app}

  zap_scan_other_container:
    description: Scan another container running on the host OS with ZAP.
    parameters:
      target:
        type: string
        description: Other container running on the host OS.
        examples:
          - sagikazarmark/dvwa

    container:
      image: zaproxy/zap-stable
      args:
        - --net=zapnet

    cmdline: # https://www.zaproxy.org/docs/docker/about/
      - zaproxy/zap-weekly
      - zap-baseline.py
      - -t
      - ${target}

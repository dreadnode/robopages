description: WPScan scans for vulnerabilities in websites running WordPress.
# https://wpscan.com/blog/wpscan-cli-cheat-sheet-poster/

functions:
  wpscan_scan:
    description: Scan a specific domain for WordPress plugins with vulnerabilities.
    parameters:
      target:
        type: string
        description: The URL of the target to scan.
        examples:
          - https://target.tld/

    container:
      image: wpscanteam/wpscan
      args:
        - --net=host
    cmdline:
      - wpscan
      - --url
      - ${target}
      - --enumerate vp

  wpscan_scan_stealthy:
    description: Scan a specific domain for WordPress vulnerabilities with stealth mode enabled.
    parameters:
      target:
        type: string
        description: The URL of the target to scan.
        examples:
          - https://target.tld/

    container:
      image: wpscanteam/wpscan
      args:
        - --net=host
    
    cmdline:
      - wpscan
      - --url
      - ${target}
      - --enumerate
      - --random-user-agent
      - --stealthy